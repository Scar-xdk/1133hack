<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Teste API Instagram</title>
</head>
<body>
    <h1>Buscar usuário do Instagram</h1>
    <input type="text" id="username" placeholder="Digite o nome de usuário">
    <button onclick="buscar()">Buscar</button>
    <h2>Resposta:</h2>
    <pre id="resultado"></pre>

    <hr>

    <h1>Buscar últimos 5 seguidores</h1>
    <input type="text" id="username_followers" placeholder="Digite o nome de usuário">
    <button onclick="buscarFollowers()">Buscar Seguidores</button>
    <h2>Resposta Seguidores:</h2>
    <pre id="resultado_followers"></pre>

    <script>
        async function buscar() {
            const username = document.getElementById('username').value;
            if (!username) {
                alert('Por favor, digite um nome de usuário.');
                return;
            }

            const resultadoDiv = document.getElementById('resultado');
            resultadoDiv.textContent = 'Buscando...';

            try {
                // A requisição é feita para o seu servidor local,
                // que então chama a API do Instagram.
                const response = await fetch(`http://localhost:5000/insta/${username}`);
                const data = await response.json();

                if (response.ok) {
                    resultadoDiv.textContent = JSON.stringify(data, null, 2);
                } else {
                    resultadoDiv.textContent = `Erro: ${data.error}`;
                }
            } catch (error) {
                console.error('Erro ao buscar:', error);
                resultadoDiv.textContent = 'Erro ao conectar com o servidor local em http://localhost:5000. Verifique se ele está rodando.';
            }
        }

        async function buscarFollowers() {
            const username = document.getElementById('username_followers').value;
            if (!username) {
                alert('Por favor, digite um nome de usuário.');
                return;
            }

            const resultadoDiv = document.getElementById('resultado_followers');
            resultadoDiv.textContent = 'Buscando...';

            try {
                const response = await fetch(`http://localhost:5000/insta/${username}/followers`);
                const data = await response.json();

                if (response.ok) {
                    resultadoDiv.textContent = JSON.stringify(data, null, 2);
                } else {
                    resultadoDiv.textContent = `Erro: ${data.error}`;
                }
            } catch (error) {
                console.error('Erro ao buscar seguidores:', error);
                resultadoDiv.textContent = 'Erro ao conectar com o servidor local em http://localhost:5000. Verifique se ele está rodando.';
            }
        }
    </script>
</body>
</html>